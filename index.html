<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obscura Life</title>
    <!-- Brand fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet"> <!-- New font for radio display -->


    <!-- Favicon -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">

    <!-- Preconnect hints -->
    <link rel="preconnect" href="https://i.ytimg.com">
    <link rel="preconnect" href="https://www.youtube-nocookie.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">

    <!-- SEO / Social -->
    <meta name="description" content="Obscura Creative blends editorial craftsmanship with generative AI to deliver future‑forward video and interactive experiences.">
    <meta property="og:title" content="Obscura Creative">
    <meta property="og:description" content="Editorial | Generative AI | Experiential">
    <meta property="og:url" content="https://www.obscura.life/">
    <meta property="og:image" content="https://www.obscura.life/og-image.jpg">
    <meta property="og:type" content="website">
    <style>
        :root {
            --accent-color: #0455BF;      /* blue */
            --background-color: #FFCB00;  /* yellow */
            --text-color: #1A1A1A;        /* off‑white */
            --card-bg-color: #FAFAFA;     /* white for panels */
            --border-radius-xl: 1rem;
            --soft-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08),
                           0 4px 6px -2px rgba(0, 0, 0, 0.04);
            --spectral-gradient: linear-gradient(90deg,
                hsl(210, 80%, 55%), hsl(220, 80%, 55%), hsl(230, 80%, 55%)); /* cleaned to a blue gradient */
            --font-sans: "Red Hat Display", system-ui, sans-serif;
            --font-serif: "Red Hat Display", Georgia, serif;
            --font-display: "VT323", monospace; /* New font for radio display */
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: var(--font-sans);
            margin: 0;
            padding: 0;
            font-size: 16px;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        section {
            padding: 40px 0;
            min-height: 80vh; /* Ensure sections are substantial for scrolling */
        }

        h1, h2, h3, .logo {
            color: var(--accent-color);
            font-weight: 600;
            font-family: var(--font-serif);
        }

        .logo {
            display:inline-block; width:45vw; max-width:600px; height:auto;

        }

        /* Generic Section Styling */
        .section-content {
            background-color: var(--card-bg-color);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--soft-shadow);
            margin-top: 6vh; /* Push content down so hero is visible initially */
        }

        /* Portfolio Section */
        #portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Responsive grid */
            gap: 1.5rem;
        }
        .portfolio-item {
            background-color: var(--card-bg-color);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--soft-shadow);
            overflow: hidden;
            position: relative;
            aspect-ratio: 16 / 9;
        }
        .portfolio-item iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .portfolio-item .placeholder {
            width:100%; height:100%;
            background-color:#000;
            background-size:cover;
            background-position:center;
            display:flex; align-items:center; justify-content:center;
            cursor:pointer;
            transition:filter .3s ease;
        }
        .portfolio-item .placeholder:hover { filter:brightness(1.2); }
        .portfolio-item .placeholder::after {
            content:'▶';
            font-size:3rem;
            color:#FFCB00;
            text-shadow:0 0 6px rgba(0,0,0,.6);
            pointer-events:none;
        }
        .portfolio-intro {
            margin-bottom: 1.25rem;
            font-size: 1rem;
            color: var(--text-color);
            opacity: 0.8;
        }


        /* Obscura rAIdio (Now a full section) */
        #radio-section .section-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        #radio-block{
            /* Removed background-color, border-radius, box-shadow to achieve single bounding box (done by .section-content) */
            padding: 1.5rem;
            margin-top: 1rem;
            width: 100%;
            max-width: 600px; /* Constrain width for radio unit */
            box-sizing: border-box;
            position: relative;
        }

        .radio-logo {
            width: 200px;
            height: auto;
            margin-bottom: 1rem;
            display: block;
        }

        #radio-audio{
            display:none; /* Hidden controls for true radio feel */
        }

        /* --- Radio Display (Scrolling Text) --- */
        #radio-display-container {
            width: 90%;
            height: 2.5rem;
            background-color: var(--background-color); /* Brand yellow */
            border: 2px solid var(--accent-color); /* Blue border */
            border-radius: 5px;
            margin-bottom: 1rem;
            overflow: hidden; /* Important for scrolling effect */
            position: relative;
            display: flex;
            align-items: center; /* Center text vertically */
            justify-content: flex-start; /* Start from left */
            padding: 0 0.5rem;
            box-sizing: border-box;
        }

        #radio-display {
            white-space: nowrap; /* Prevent text wrapping */
            font-family: var(--font-display); /* Monospaced font for LCD look */
            color: var(--card-bg-color); /* Brand white */
            font-size: 1.6em; /* Increased font size */
            position: absolute;
            left: 0;
            animation: none; /* Controlled by JS */
        }

        /* Animation for seeking effect on display text */
        @keyframes seekFade {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        #radio-display.seek-active {
            animation: seekFade 0.3s ease-out;
        }


        /* --- Radio Controls Grid Layout --- */
        .radio-controls-grid {
            display: grid;
            grid-template-columns: 1fr auto auto auto 1fr; /* Volume, Seek, Play/Pause, Seek, Freq */
            align-items: center;
            gap: 1.5rem;
            margin-top: 1.5rem;
            width: 100%;
        }
        .radio-controls-grid > * {
            place-self: center;
        }

        .radio-component {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .dial-label {
            font-weight: 600;
            user-select: none;
            color: var(--accent-color);
            font-size: 0.9em;
        }

        /* Volume Dial */
        .volume-component {
            grid-column: 1;
            height: 120px;
            justify-content: center;
            position: relative;
            box-sizing: border-box;
            flex-direction: column-reverse; /* Puts label below input */
        }
        .volume-component .dial-label {
             margin-top: 0.5rem; /* Space between dial and label */
             margin-bottom: 0; /* Ensures no extra space below label */
        }


        .volume-component input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100px;
            height: 20px;
            background: transparent;
            cursor: pointer;
            outline: none;
            transform: rotate(-90deg);
            margin: 0;
            position: relative;
            z-index: 2;
        }
        .volume-component input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--accent-color);
            border: 3px solid var(--card-bg-color);
            box-shadow: 0 0 0 3px var(--accent-color);
            transition: background .3s ease;
        }
        .volume-component input[type="range"]::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--accent-color);
            border: 3px solid var(--card-bg-color);
            box-shadow: 0 0 0 3px var(--accent-color);
            transition: background .3s ease;
        }

        /* Volume Track Background */
        .volume-component .volume-track {
            position: absolute;
            width: 6px;
            height: 100px;
            background: #bbb;
            border-radius: 3px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }


        /* Play / pause button */
        #play-pause{
            width:50px;height:50px;border-radius:50%;
            background:var(--accent-color);color:var(--background-color);
            border:none;cursor:pointer;font-weight:bold;
            font-size:1.5rem;line-height:1;
            grid-column: 3;
        }
        #play-pause.paused::after{content:'►';}
        #play-pause.playing::after{content:'❚❚';}

        /* Seek buttons */
        .seek-button {
            background-color: var(--accent-color);
            color: #fff;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
        }
        #seek-left { grid-column: 2; }
        #seek-right { grid-column: 4; }

        .seek-button:hover {
             background-image: var(--spectral-gradient);
             color: white;
        }

        /* Frequency Dial (Round Tuning Dial) */
        .freq-component {
            grid-column: 5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #tuning-dial {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #e0e0e0;
            border: 2px solid var(--accent-color);
            position: relative;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.1s ease;
        }

        #tuning-dial:hover {
            transform: scale(1.05);
        }
        #tuning-dial.seeking {
            animation: dialTurn 0.3s ease-out forwards;
        }
        @keyframes dialTurn {
            0%   { transform: rotate(0deg); }
            50%  { transform: rotate(90deg); } /* Rotates fully in the middle of animation */
            100% { transform: rotate(0deg); }
        }

        .dial-arrow {
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 12px solid var(--accent-color);
            position: absolute;
            top: 5px;
        }


        /* About / Contact */
        .tool-badges img {
            height: 30px;
            margin: 5px;
            border-radius: 4px;
        }
        .tool-badges span {
            background-color: var(--card-bg-color);
            padding: 5px 10px;
            border-radius: 5px;
            margin: 5px; display: inline-block;
            border: 1px solid var(--accent-color);
            transition: background-color .3s ease, color .3s ease, border-color .3s ease; /* For hover */
        }
        .tool-badges span:hover {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        /* Changed h4 to h3 for proper section heading */
        .tool-badges h3{ /* Updated selector */
            margin:1.2rem 0 0.4rem;
            font-size:1.15rem;
            font-weight:700;
            color:var(--accent-color);
        }
        .contact-links a {
            color: var(--accent-color);
            text-decoration: none;
            margin-right: 15px;
        }
        .contact-links a:hover {
            text-decoration: underline;
             background-image: var(--spectral-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem;
            font-size: 0.8em;
            border-top: 1px solid #222;
        }
        #easter-egg {
            cursor: help;
            text-decoration: underline dotted;
        }

        /* Accessibility */
        *:focus-visible {
            outline: 2px solid var(--accent-color);
            outline-offset: 2px;
        }

        /* 12-column grid - apply .grid-container and .col-* as needed */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 1rem;
        }
        /* Example .col-* */
        .col-12 { grid-column: span 12; }
        .col-6 { grid-column: span 6; }

        #landing-hero{
            position:relative;width:100%;height:100vh;overflow:hidden;
            display:flex;align-items:center;justify-content:center;
        }
        .landing-inner{
            text-align:center;
            position:relative;
            z-index:5;
            opacity:0;
            animation:fadeIn 1s ease-out .3s forwards;
        }
        .landing-nav{
            margin-top:0.15rem;
            display:flex;
            gap:2rem;
            justify-content:center;
            flex-wrap:wrap;
        }
        .landing-link{color:var(--accent-color);font-family:var(--font-sans);font-weight:600;
            text-decoration:none;font-size:1.25rem;transition:color .3s;
            opacity:0;
            animation:fadeIn .8s ease-out .6s forwards;
        }
        .landing-link:hover{color:#fff;}
        section:not(#landing-hero){scroll-margin-top:80px;}

        /* Portfolio reveal animation */
        .portfolio-item        {opacity:0; transform:translateY(20px);
                                transition:opacity .6s ease, transform .6s ease;}
        .portfolio-item.visible{opacity:1; transform:translateY(0);}

        /* Mobile tweaks */
        @media (max-width:600px){
          h1.logo          {font-size:2rem;}
          .landing-nav     {flex-direction:column; gap:1rem;}
          #portfolio-grid  {grid-template-columns:repeat(auto-fit,minmax(160px,1fr));}
          .portfolio-intro {font-size:.9rem; text-align:center;}
          .radio-controls-grid {
              grid-template-columns: 1fr 1fr 1fr;
              gap: 0.5rem;
          }
          .volume-component, .freq-component {
              grid-column: span 1;
              margin: auto;
          }
          #play-pause, #seek-left, #seek-right {
              grid-column: span 1;
              margin: auto;
          }
        }


        /* Lightbox */
        #lightbox{
            position:fixed; inset:0;
            background:rgba(0,0,0,.8);
            display:flex; align-items:center; justify-content:center;
            visibility:hidden; opacity:0; transition:opacity .3s ease;
            z-index:200;
        }
        #lightbox.visible{visibility:visible; opacity:1;}
        #lightbox-content{width:90vw; max-width:1280px; aspect-ratio:16/9; max-height:90vh;}
        #lightbox-content iframe{width:100%; height:100%; border:none;}
        #lightbox-close{
            position:absolute; top:20px;  right:30px;
            font-size:2rem; color:#fff; cursor:pointer; user-select:none;
        }
        @keyframes fadeIn{
            from{opacity:0;}
            to  {opacity:1;}
        }
    </style>
</head>
<body>


    <!-- Landing Hero -->
    <section id="landing-hero">
        <!-- Sphere canvas removed -->
        <div class="landing-inner">
            <img src="/logo/Obscura-logo.svg"
                 alt="Obscura Creative"
                 class="logo" />
            <nav class="landing-nav">
                <a href="#portfolio" class="landing-link">Editorial</a>
                <a href="#radio-section" class="landing-link">Obscura rAIdio</a>
                <a href="#tools-section" class="landing-link">Tools</a> <!-- New link for tools section -->
                <a href="#contact-section" class="landing-link">Contact</a>
            </nav>
        </div>
    </section>



    <main>
        <div id="now-clock-section"></div> <!-- Dummy anchor for "Now" hex nav item -->

        <section id="portfolio" class="container">
            <div class="section-content">
                <h2>Portfolio</h2>
                <p class="portfolio-intro">
                    Click any thumbnail to view the spot in full screen.
                </p>
                <div id="portfolio-grid">
                    <!-- Portfolio items will be injected by JS -->
                </div>
            </div>
        </section>

        <!-- Obscura rAIdio section -->
        <section id="radio-section" class="container">
            <div class="section-content">
                <img src="/logo/raidio.svg" alt="Obscura rAIdio Logo" class="radio-logo">
                <!-- Removed "Sounds for the liminal space." paragraph -->
                <div id="radio-block">
                    <div id="radio-display-container">
                        <div id="radio-display"></div>
                    </div>

                    <div class="radio-controls-grid">
                        <div class="radio-component volume-component">
                            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.8" aria-label="Volume dial">
                            <div class="volume-track"></div>
                            <label for="volume-slider" class="dial-label">VOL</label>
                        </div>

                        <button id="seek-left" class="seek-button" aria-label="Seek previous station">◀◀</button>

                        <button id="play-pause" aria-label="Play or Pause"></button>

                        <button id="seek-right" class="seek-button" aria-label="Seek next station">▶▶</button>

                        <div class="radio-component freq-component">
                            <div id="tuning-dial" role="button" aria-label="Tuning dial, click to change station">
                                <span class="dial-arrow"></span>
                            </div>
                            <span class="dial-label" id="band-label">FREQ</span>
                        </div>
                    </div>
                    <audio id="radio-audio" preload="metadata"></audio>
                </div>
            </div>
        </section>

        <!-- New Tools Section -->
        <section id="tools-section" class="container">
            <div class="section-content">
                <h2>Tools We Love / Are Cautiously Experimenting With</h2>
                <div class="tool-badges">
                    <h3>Video & Streaming</h3>
                    <span title="Industry-standard video editing software.">Premiere</span>
                    <span title="Advanced motion graphics and visual effects.">After Effects</span>
                    <span title="Free and open-source software for video recording and live streaming.">OBS</span>
                    
                    <h3>AI Creative</h3>
                    <span title="Powerful large language model by OpenAI for text generation.">ChatGPT</span>
                    <span title="Google's family of generative AI models.">Gemini</span>
                    <span title="AI image generation from text prompts.">Midjourney</span>
                    <span title="OpenAI's text-to-video AI model.">Sora</span>
                    <span title="Adobe's generative AI tools for images and text effects.">Firefly</span>
                    <span title="AI video generation and editing tools.">RunwayML</span>
                    <span title="AI music generation from text.">Suno</span>

                    <h3>3D & Interactive</h3>
                    <span title="Real-time 3D development platform for games, simulations, and more.">Unity</span>
                    <span title="Free and open-source 3D creation suite.">Blender</span>
                    <span title="AI platform for generating 3D models and environments from videos.">Luma AI</span>
                    <span title="Software for 3D printing preparation and control.">BambuStudio</span>

                    <h3>Imaging & Design</h3>
                    <span title="Adobe's industry-standard image manipulation software.">Photoshop</span>
                    <span title="Vector graphics software for logos, icons, and illustrations.">Illustrator</span>
                    <span title="Image organization and raw photo editing software.">Lightroom</span>
                </div>
            </div>
        </section>


        <section id="about" class="container">
            <div class="section-content">
                <h2>About Obscura Creative</h2>
                <p>Obscura Creative Inc. explores the intersection of light, perception, and digital artistry. We specialize in cutting-edge video editing, AI-driven content pipelines, and immersive web experiences.</p>
                <p>We believe in the power of sacred geometry, the magic of optics, and the endless flow of time as inspirations for transformative digital art.</p>

                <div id="contact-section"> <!-- Combined About/Contact -->
                    <h3>Connect</h3>
                    <p class="contact-links">
                        Email: <a href="mailto:max@obscura.life">max@obscura.life</a>
                        <a href="https://www.linkedin.com/company/obscura-creative-inc" target="_blank" rel="noopener noreferrer" aria-label="Obscura Creative Inc. on LinkedIn">
                            LinkedIn
                        </a>
                    </p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>©2025 Obscura Creative Inc. <span id="easter-egg" title="What could it be?">All rights reserved.</span></p>
    </footer>

    <!-- Lightbox modal -->
    <div id="lightbox" aria-hidden="true">
        <div id="lightbox-content"></div>
        <span id="lightbox-close" aria-label="Close lightbox">×</span>
    </div>

    <script type="module">
        // Import paths for CDN
        const ANIME_PATH = 'https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.es.js';
        const DAYJS_PATH = 'https://cdn.jsdelivr.net/npm/dayjs@1.11.10/dayjs.min.js';
        const DAYJS_TZ_PATH = 'https://cdn.jsdelivr.net/npm/dayjs@1.11.10/plugin/timezone.js';
        const DAYJS_UTC_PATH = 'https://cdn.jsdelivr.net/npm/dayjs@1.11.10/plugin/utc.js';

        let Anime, Dayjs; // Modules to be loaded

        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        // --- UTILITIES ---
        function smoothScrollTo(targetId) {
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 100, // Offset for fixed headers/nav
                    behavior: prefersReducedMotion ? 'auto' : 'smooth'
                });
            }
        }

        // Fisher-Yates (Knuth) Shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        // --- INITIALIZATION FUNCTION ---
        async function initializeSite() {
            if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
            // Clear any URL hash so the browser can't auto‑scroll to anchors on load
            if (location.hash) {
                history.replaceState(null, '', location.pathname + location.search);
            }
            window.scrollTo(0, 0);
            // Dynamically import heavy libraries
            [
                { name: 'Anime', path: ANIME_PATH, isDefault: true },
                { name: 'Dayjs', path: DAYJS_PATH, isWindow: true, globalName: 'dayjs' }
            ].forEach(async (lib) => {
                if (lib.isWindow) { // For libs like Dayjs min that attach to window
                    await import(lib.path);
                    if (lib.globalName === 'dayjs') {
                        Dayjs = window.dayjs;
                        await import(DAYJS_UTC_PATH); // Ensure this loads and registers plugin
                        await import(DAYJS_TZ_PATH);  // Ensure this loads and registers plugin
                        Dayjs.extend(window.dayjs_plugin_utc);
                        Dayjs.extend(window.dayjs_plugin_timezone);
                    } else {
                        window[lib.name] = window[lib.globalName];
                    }
                } else if (lib.isDefault) {
                    const module = await import(lib.path);
                    window[lib.name] = module.default;
                } else {
                    window[lib.name] = await import(lib.path);
                }
                if (lib.name === 'Anime') Anime = window.Anime;
            });


            // Wait for Dayjs and Anime.js to be available for critical UI elements
            await new Promise(resolve => {
                const interval = setInterval(() => {
                    if (typeof Dayjs !== 'undefined' && typeof Anime !== 'undefined' && typeof Dayjs.tz !== 'undefined') {
                        clearInterval(interval);
                        resolve();
                    }
                }, 50);
            });

            initNav();
            initPortfolio();
            initRadio();
            initFooterEasterEgg();
        }


        // --- HERO CANVAS (Removed) ---
        // The initHeroCanvas function and any Three.js specific code were removed.


        // --- SACRED-NETWORK NAV OVERLAY ---
        function initNav() {
            // Navigation overlay removed; nothing to initialize.
        }

        // --- "NOW" CLOCK & CN-TOWER SUNDIAL WIDGET ---
        // (Removed)


        // --- PORTFOLIO SECTION ---
        function initPortfolio() {
            const portfolioGrid = document.getElementById('portfolio-grid');
            if (!portfolioGrid) return;

            // Reveal items when they enter viewport
            const revealObs = new IntersectionObserver(entries=>{
                entries.forEach(e=>{
                    if(e.isIntersecting){
                        e.target.classList.add('visible');
                        revealObs.unobserve(e.target);
                    }
                });
            },{threshold:0.15});

            // Pagination state
            const PAGE_SIZE = 9;
            let currentPage = 0;

            // Fetch portfolio data and build the grid
            fetch('/content/portfolio.json')
                .then(r => r.json())
                .then(list => {
                    // sort by Rank if present
                    list.sort((a, b) => (a.Rank || 0) - (b.Rank || 0));

                    function renderPage() {
                        const start = currentPage * PAGE_SIZE;
                        const end   = start + PAGE_SIZE;
                        const slice = list.slice(start, end);

                        slice.forEach(entry => {
                            const id    = entry.VideoID || entry.id || entry.videoId;
                            const title = entry.Title    || entry.title || '';
                            if (!id) return;

                            const item = document.createElement('div');
                            item.className = 'portfolio-item';
                            item.dataset.videoId = id;
                            item.setAttribute('aria-label', title);

                            const placeholder = document.createElement('div');
                            placeholder.className = 'placeholder';
                            // Set YouTube thumbnail as background
                            placeholder.style.backgroundImage = `url(https://i.ytimg.com/vi/${id}/hqdefault.jpg)`;
                            placeholder.setAttribute('role', 'button');
                            placeholder.setAttribute('tabindex', '0');
                            placeholder.setAttribute('aria-label', `Load video ${title}`);

                            item.appendChild(placeholder);
                            portfolioGrid.appendChild(item);
                            revealObs.observe(item);

                            // (Auto-open first video removed)

                            placeholder.addEventListener('click',   () => openLightbox(id, title));
                            placeholder.addEventListener('keypress',e => {
                                if (e.key === 'Enter' || e.key === ' ') openLightbox(id, title);
                            });
                        });

                        if ((currentPage + 1) * PAGE_SIZE < list.length) addLoadMoreButton();
                    }

                    function addLoadMoreButton() {
                        const btn = document.createElement('button');
                        btn.textContent = 'Load More';
                        btn.style.cssText = 'grid-column: 1 / -1; margin: 1rem auto; padding: .75rem 1.5rem; background: var(--accent-color); color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:bold;';
                        btn.addEventListener('click', () => {
                            btn.remove();
                            currentPage++;
                            renderPage();
                        });
                        portfolioGrid.appendChild(btn);
                    }

                    renderPage();   // initial page
                })
                .catch(err => {
                    console.error('Failed to load portfolio.json', err);
                });
        }

        // --- LIGHTBOX ---
        const lightbox      = document.getElementById('lightbox');
        const lightboxInner = document.getElementById('lightbox-content');
        const lightboxClose = document.getElementById('lightbox-close');

        function openLightbox(id, title='') {
            if (!lightbox) return;
            lightboxInner.innerHTML =
                `<iframe loading="lazy"
                         src="https://www.youtube-nocookie.com/embed/${id}?autoplay=1&playsinline=1&mute=0&vq=hd720&rel=0&modestbranding=1&showinfo=0"
                         title="${title || 'Obscura video'}"
                         allow="autoplay; accelerometer; encrypted-media; gyroscope; picture-in-picture"
                         allowfullscreen></iframe>`;
            lightbox.classList.add('visible');
            lightbox.setAttribute('aria-hidden','false');
        }

        if (lightboxClose) {
            lightboxClose.addEventListener('click', closeLightbox);
            lightbox.addEventListener('click', (e)=> { if(e.target===lightbox) closeLightbox(); });
            document.addEventListener('keydown', (e)=> { if(e.key==='Escape') closeLightbox(); });
        }

        function closeLightbox() {
            lightbox.classList.remove('visible');
            lightbox.setAttribute('aria-hidden','true');
            lightboxInner.innerHTML='';
        }


        // --- UPDATED OBSCURA rAIDIO ---
        function initRadio() {
            const audio       = document.getElementById('radio-audio');
            const playBtn     = document.getElementById('play-pause');
            const seekLeftBtn = document.getElementById('seek-left');
            const seekRightBtn= document.getElementById('seek-right');
            const bandLbl     = document.getElementById('band-label');
            const radioDisplay= document.getElementById('radio-display');
            const tuningDial  = document.getElementById('tuning-dial');
            const volSl       = document.getElementById('volume-slider');

            if (!audio || !playBtn || !seekLeftBtn || !seekRightBtn || !bandLbl || !radioDisplay || !tuningDial || !volSl) return;

            // Define ad bumper tracks with durations (in seconds)
            const ADS = [
                { title: 'Ad Spot 01', url: '/audio/ads/Ad01.mp3', duration: 15 },
                { title: 'Ad Spot 02', url: '/audio/ads/Ad02.mp3', duration: 10 },
                { title: 'Ad Spot 03', url: '/audio/ads/Ad03.mp3', duration: 20 }
            ];

            // Define the stations with song durations (in seconds)
            const stations = [
                {
                    name: 'Obscura Talk Radio',
                    frequency: '88.3 AM',
                    type: 'AM',
                    playlist: [{ title: 'NotebookLM Podcast', url: '/audio/am/NotebookLM-Podcast.mp3', duration: 1800 }], // 30 minutes
                    streamTimeline: [], // Computed on init, maps sequence
                    lastKnownTrackIndex: 0, // Last track played from this station's sequence
                },
                {
                    name: 'Madness FM',
                    frequency: '103.1 FM',
                    type: 'FM',
                    playlist: shuffleArray([
                        { title:'All Of My Bins', url:'/audio/fm01/All-Of-My-Bins.mp3', duration: 180 },
                        { title:'FatRatʼs Saga', url:'/audio/fm01/FatRats-Saga.mp3', duration: 210 },
                        { title:'Make the Website', url:'/audio/fm01/Make-the-Website.mp3', duration: 150 },
                        { title:'Out Exploring', url:'/audio/fm01/Out-Exploring.mp3', duration: 195 },
                        { title:'Slop Slop Slop', url:'/audio/fm01/Slop-Slop-Slop.mp3', duration: 200 },
                        { title:'Squallʼs AI Ghul', url:'/audio/fm01/Squalls-AI-Ghul.mp3', duration: 170 },
                        { title:'Tell Me', url:'/audio/fm01/Tell-Me.mp3', duration: 160 },
                        { title:'Wizard of Moscow', url:'/audio/fm01/Wizard-of-Moscow.mp3', duration: 220 }
                    ]),
                    adPlaylist: shuffleArray([...ADS]), // Deep copy & shuffle for independence
                    streamTimeline: [],
                    lastKnownTrackIndex: 0,
                },
                {
                    name: 'Unhinged FM',
                    frequency: '98.9 FM',
                    type: 'FM',
                    playlist: shuffleArray([
                        { title:'Distracted by Skeletons', url:'/audio/fm02/Distracted-by-Skeletons.mp3', duration: 165 },
                        { title:'Fractals', url:'/audio/fm02/Fractals.mp3', duration: 205 },
                        { title:'Good Game!', url:'/audio/fm02/Good-Game.mp3', duration: 190 },
                        { title:'Missing You (Cover)', url:'/audio/fm02/Missing-You.mp3', duration: 230 },
                        { title:'Obscura Sonnet', url:'/audio/fm02/Obscura-Sonnet.mp3', duration: 175 },
                        { title:'Prism', url:'/audio/fm02/Prism.mp3', duration: 140 },
                        { title:'Puppet', url:'/audio/fm02/Puppet.mp3', duration: 185 },
                        { title:'Quiet Anvil', url:'/audio/fm02/Quiet-Anvil.mp3', duration: 215 },
                        { title:'Too Far Apart', url:'/audio/fm02/Too-Far-Apart.mp3', duration: 155 },
                        { title:'Why Do You Look Like a Dragon', url:'/audio/fm02/Why-Do-You-Look-Like-a-Dragon.mp3', duration: 240 }
                    ]),
                    adPlaylist: shuffleArray([...ADS]), // Deep copy & shuffle
                    streamTimeline: [],
                    lastKnownTrackIndex: 0,
                }
            ];

            // --- Stream Pre-computation ---
            // This builds a complete, cyclical sequence of songs/ads for each FM station
            stations.forEach(station => {
                let currentTotalDuration = 0;
                station.streamTimeline = []; // Reset for clarity on rebuild

                if (station.type === 'AM') {
                    const track = station.playlist[0]; // AM just has one track
                    station.streamTimeline.push({
                        item: track,
                        start: 0,
                        duration: track.duration,
                        isAd: false
                    });
                    // AM acts as if its cycle is infinite, but we'll use its duration for direct seek calculation.
                    station.cycleDuration = track.duration;
                } else { // FM stations: Interleave songs and ads
                    // Ensure playlists are at least as long as each other by cycling content if needed
                    const longestPlaylistLength = Math.max(station.playlist.length, station.adPlaylist.length);

                    for (let i = 0; i < longestPlaylistLength; i++) {
                        const song = station.playlist[i % station.playlist.length]; // Cycle songs if ad list is longer
                        station.streamTimeline.push({
                            item: song,
                            start: currentTotalDuration,
                            duration: song.duration,
                            isAd: false
                        });
                        currentTotalDuration += song.duration;

                        const ad = station.adPlaylist[i % station.adPlaylist.length]; // Cycle ads if song list is longer
                        station.streamTimeline.push({
                            item: ad,
                            start: currentTotalDuration,
                            duration: ad.duration,
                            isAd: true
                        });
                        currentTotalDuration += ad.duration;
                    }
                    station.cycleDuration = currentTotalDuration;
                }
            });


            let currentStationIndex = 0;
            let scrollAnimationFrameId; // To control requestAnimationFrame for scrolling text

            // Function to manage the scrolling display
            function updateScrollingDisplay(text, seekActive = false) {
                cancelAnimationFrame(scrollAnimationFrameId); // Stop any ongoing scroll animation

                radioDisplay.classList.toggle('seek-active', seekActive);

                if (seekActive) {
                    radioDisplay.textContent = 'SEEKING...';
                    radioDisplay.style.transform = 'translateX(0)'; // Reset position
                    radioDisplay.addEventListener('animationend', function handler() {
                        radioDisplay.classList.remove('seek-active');
                        startContinuousScrolling(radioDisplay, text);
                        this.removeEventListener('animationend', handler);
                    }, { once: true });
                } else {
                    startContinuousScrolling(radioDisplay, text);
                }
            }

            function startContinuousScrolling(element, originalText) {
                cancelAnimationFrame(scrollAnimationFrameId);
                element.style.transform = 'translateX(0)'; // Reset initial position

                // Add padding spaces to the text to ensure visible gap before repetition
                const paddedText = originalText + '         '; // 9 spaces
                element.innerHTML = paddedText + paddedText; // Duplicate for seamless looping

                setTimeout(() => { // Allow DOM to render for accurate scrollWidth
                    const containerWidth = element.parentElement.clientWidth - (parseFloat(getComputedStyle(element.parentElement).paddingLeft) * 2);
                    const singleTextWidth = element.scrollWidth / 2; // Width of one padded text instance

                    if (singleTextWidth <= containerWidth && !prefersReducedMotion) {
                        // If text fits, but still want a 'scroll' feel
                        // Make it subtly scroll slowly or reset to show full text.
                        element.style.transform = 'translateX(0)';
                        element.innerHTML = originalText; // Revert to single text
                        // You could add a subtle slow scroll here if needed, or simply static for fit
                        return;
                    } else if (prefersReducedMotion) {
                        // Just show static text if reduced motion is preferred
                        element.style.transform = 'translateX(0)';
                        element.innerHTML = originalText;
                        return;
                    }


                    let currentPosition = 0;
                    const scrollSpeed = 0.5; // pixels per frame

                    function animateScroll() {
                        currentPosition -= scrollSpeed;
                        // When the first full copy has scrolled off the left edge, reset to start.
                        if (currentPosition <= -singleTextWidth) {
                            currentPosition = 0;
                        }
                        element.style.transform = `translateX(${currentPosition}px)`;
                        scrollAnimationFrameId = requestAnimationFrame(animateScroll);
                    }
                    scrollAnimationFrameId = requestAnimationFrame(animateScroll);
                }, 50); // Small delay
            }


            // This function now calculates the "current live moment" in the stream and plays it
            function tuneToStation(station, isSeekAction = false) {
                const nowInSeconds = Date.now() / 1000;
                let playDuration = station.cycleDuration;
                if (station.type === 'AM') { // AM is simpler, effectively just loops its one podcast
                    playDuration = station.playlist[0].duration;
                }

                // Calculate where we are in the continuous stream's cycle
                const timeInCycle = nowInSeconds % playDuration;

                let trackToPlay = null;
                let startTimeForAudio = 0;

                // Find which segment in the stream is playing at 'timeInCycle'
                for (const segment of station.streamTimeline) {
                    if (timeInCycle >= segment.start && timeInCycle < (segment.start + segment.duration)) {
                        trackToPlay = segment.item;
                        startTimeForAudio = timeInCycle - segment.start; // Calculate offset into this specific track
                        break;
                    }
                }

                // Fallback in case calculation fails (should not happen with proper setup)
                if (!trackToPlay && station.streamTimeline.length > 0) {
                    trackToPlay = station.streamTimeline[0].item;
                    startTimeForAudio = 0;
                } else if (!trackToPlay) { // Absolute fallback if stream timeline is empty
                    return; // Cannot play anything
                }

                const displayString = `${station.frequency} ${station.name}: ${trackToPlay.title}`;
                updateScrollingDisplay(displayString, isSeekAction); // Update scrolling text

                audio.src = trackToPlay.url;
                audio.onloadedmetadata = () => {
                    // Set current time to always be 0.
                    // This resolves the user's explicit request: "songs must always start right at the very beginning".
                    audio.currentTime = 0; // Always start at 0:00

                    if (playBtn.classList.contains('playing')) {
                         audio.play().catch(e => console.warn("Autoplay prevented:", e));
                    }
                };

                if (!playBtn.classList.contains('playing')) {
                    audio.load(); // Preload even if paused
                }
            }


            // Handles logic for when a track ends naturally (automatic progression within the station's stream)
            audio.addEventListener('ended', () => {
                const currentStation = stations[currentStationIndex];
                // Simply retune to the current station to get the next track in its stream.
                // The 'ended' event means the current segment finished, so the time will naturally advance.
                tuneToStation(currentStation);
            });


            /* Play / pause button */
            playBtn.classList.add('paused'); // Initial state
            playBtn.addEventListener('click', () => {
                if (audio.paused) {
                    audio.play().catch(e => console.warn("Autoplay prevented:", e));
                    playBtn.classList.replace('paused', 'playing');
                } else {
                    audio.pause();
                    playBtn.classList.replace('playing', 'paused');
                }
            });

            volSl.addEventListener('input', () => { audio.volume = volSl.valueAsNumber; });

            // Seek functionality
            function seekStation(direction) {
                currentStationIndex += direction;
                if (currentStationIndex < 0) {
                    currentStationIndex = stations.length - 1; // Wrap around to last station
                } else if (currentStationIndex >= stations.length) {
                    currentStationIndex = 0; // Wrap around to first station
                }

                // Animate tuning dial
                tuningDial.classList.add('seeking');
                tuningDial.addEventListener('animationend', function handler() {
                    tuningDial.classList.remove('seeking');
                    this.removeEventListener('animationend', handler);
                }, { once: true });

                const newStation = stations[currentStationIndex];
                tuneToStation(newStation, true); // True indicates a seek action for animation
            }

            seekLeftBtn.addEventListener('click', () => seekStation(-1));
            seekRightBtn.addEventListener('click', () => seekStation(1));
            tuningDial.addEventListener('click', () => seekStation(1)); // New frequency dial clicks to seek right

            /* Init */
            audio.volume = volSl.valueAsNumber;
            tuneToStation(stations[currentStationIndex]); // Load and prepare the initial station
        }

        // --- FOOTER EASTER EGG ---
        function initFooterEasterEgg() {
            const eggTrigger = document.getElementById('easter-egg');
            if (eggTrigger) {
                eggTrigger.addEventListener('click', () => {
                    alert("None shall hold the Scepter of Alex");
                });
            }
        }

        // --- START THE SITE ---
        document.addEventListener('DOMContentLoaded', initializeSite);
    </script>
</body>
</html>